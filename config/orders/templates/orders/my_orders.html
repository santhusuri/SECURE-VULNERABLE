{% extends "base.html" %}
{% load static %}
{% block title %}My Orders{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/my_orders.css' %}">
{% endblock %}

{% block content %}
<div class="my-orders-container">
  <h2>ðŸ“¦ My Orders</h2>

  {% if orders %}
    {% for order in orders %}
      <div class="order-card">
        <div class="order-header">
          <h3>Order #{{ order.id }}</h3>

          {% if order.shipment.first %}
            <span class="status {{ order.shipment.first.status|lower }}">
              {{ order.shipment.first.status }}
            </span>
          {% else %}
            <span class="status other">No Shipment</span>
          {% endif %}
        </div>

        <p><strong>Placed on:</strong> {{ order.created_at|date:"F j, Y, g:i a" }}</p>
        <p><strong>Total:</strong> ${{ order.total }}</p>

        <p class="order-actions">
          <a href="{% url 'orders:download_invoice' order.id %}" class="btn">Download Invoice</a>
          <a href="{% url 'shipping:shipping_details' order.id %}" class="btn-secondary">View Shipping Details</a>
        </p>

        <table class="order-table">
          <thead>
            <tr>
              <th>Product</th>
              <th>Image</th>
              <th>Quantity</th>
              <th>Price</th>
            </tr>
          </thead>
          <tbody>
          {% for item in order.items.all %}
            <tr>
              <td>{{ item.product.name }}</td>
              <td>
                {% if item.product.image %}
                  <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="product-image">
                {% else %}
                  <span>No image</span>
                {% endif %}
              </td>
              <td>{{ item.quantity }}</td>
              <td>${{ item.price }}</td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    {% endfor %}
  {% else %}
    <p>You havenâ€™t placed any orders yet.</p>
  {% endif %}
</div>
{% endblock %}
