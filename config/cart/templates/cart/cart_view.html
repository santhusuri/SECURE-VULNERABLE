{% extends "base.html" %}
{% block title %}Your Cart{% endblock %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/cart.css' %}">
{% endblock %}
{% block content %}
<h2>Your Shopping Cart</h2>
{% if cart %}
<table>
    <thead>
        <tr>
            <th>Product</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Subtotal</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for id, item in cart.items %}
        <tr>
            <td>{{ item.name }}</td>
            <td>
                <form action="{% url 'cart:update_quantity' id %}" method="post" style="display: inline-flex; align-items: center;">
                {% csrf_token %}
                <button type="submit" name="action" value="decrease" aria-label="Decrease quantity" class="qty-btn">âˆ’</button>
                <input type="text" name="qty" value="{{ item.qty }}" size="2" readonly style="text-align: center; border: none; background: transparent; width: 30px;" aria-live="polite" aria-atomic="true"/>
                <button type="submit" name="action" value="increase" aria-label="Increase quantity" class="qty-btn">+</button>
                </form>
            </td>
            <td>${{ item.price|floatformat:2 }}</td>
            <td>${{ item.subtotal|floatformat:2 }}</td>
            <td>
                <form action="{% url 'cart:remove_from_cart' id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-remove" aria-label="Remove {{ item.name }} from cart">Remove</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<p><strong>Total:</strong> ${{ total|floatformat:2 }}</p>
<form action="{% url 'cart:clear_cart' %}" method="post" style="display:inline;">
    {% csrf_token %}
    <button type="submit" class="btn btn-clear">Clear Cart</button>
</form>
<a href="{% url 'orders:checkout' %}" class="btn btn-checkout">Proceed to Checkout</a>
<a href="{% url 'products:product_list' %}" class="btn btn-continue">Continue Shopping</a>
{% else %}
<p>Your cart is empty.</p>
{% endif %}
{% endblock %}
